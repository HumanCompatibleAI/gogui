<?xml version="1.0"?>
<!--
Build file for Apache Ant (http://ant.apache.org/)

$Id$
$Source$
-->

<project name="GoGui" default="all">

<property environment="env"/>
<property name="xsldir" value="${env.XSLDIR}"/>

<target name="all" depends="
 gmptogtp.jar,
 gogui.jar,
 gtpdummy.jar,
 gtpregress.jar,
 gtpserver.jar,
 netgtp.jar,
 sgftotex.jar,
 twogtp.jar
"/>

<target name="clean">
<delete failonerror="false" includeEmptyDirs="true">
<fileset dir="build/doc"/>
<fileset dir="build/gmp"/>
<fileset dir="build/gmptogtp"/>
<fileset dir="build/go"/>
<fileset dir="build/gtp"/>
<fileset dir="build/gtpdummy"/>
<fileset dir="build/gtpregress"/>
<fileset dir="build/gui"/>
<fileset dir="build/images"/>
<fileset dir="build/latex"/>
<fileset dir="build/netgtp"/>
<fileset dir="build/sgf"/>
<fileset dir="build/sgftotex"/>
<fileset dir="build/twogtp"/>
<fileset dir="build/utils"/>
<fileset dir="build/version"/>
<fileset dir="." includes="gogui.jar"/>
</delete>
</target>

<target name="compile" depends="version,doc">
<javac srcdir="src" destdir="build" source="1.4" deprecation="true"
 optimize="true" listfiles="yes"/>
<copy todir="build">
<fileset dir="." includes="images/*.png"/>
</copy>
<copy todir="build/doc">
<fileset dir="doc/html" includes="*.html"/>
</copy>
<copy todir="build/config">
<fileset dir="config" includes="analyze-commands"/>
</copy>
</target>

<target name="doc" depends="docCheckUptodate" unless="docUptodate">
<style basedir="doc/xml" includes="book.xml" destdir="doc/html"
 style="${xsldir}/html/chunk.xsl" force="true">
<param name="admon.graphics" expression="0"/>
<param name="admon.graphics.path" expression=""/>
<param name="chunk.section.depth" expression="0"/>
<param name="html.cleanup" expression="1"/>
<param name="html.stylesheet" expression="docbook.css"/>
<param name="make.valid.html" expression="1"/>
<param name="navig.showtitles" expression="0"/>
<param name="refentry.generate.name" expression="0"/>
<param name="refentry.generate.title" expression="1"/>
<param name="spacing.paras" expression="0"/>
<param name="toc.section.depth" expression="0"/>
<param name="use.id.as.filename" expression="1"/>
</style>
</target>

<target name="docCheckUptodate">
<uptodate property="docUptodate" targetfile="doc/html/index.html">
<srcfiles dir= "doc/xml" includes="*.xml"/>
</uptodate>
</target>

<target name="gmptogtp.jar" depends="compile">
<jar destfile="gmptogtp.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="gmptogtp.GmpToGtp"/>
</manifest>
<fileset dir="build" includes="
 gmp/*.class
 gmptogtp/*.class
 gtp/GtpServer.class
 utils/Options.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="gogui.jar" depends="compile">
<jar destfile="gogui.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="gui.GoGui"/>
</manifest>
<fileset dir="build" includes="
 config/analyze-commands
 doc/*.html
 go/*.class
 gtp/*.class
 gui/*.class
 images/*.png
 latex/*.class
 sgf/*.class
 utils/*.class
 version/Version.class
"/>
</jar>
</target>

<target name="gtpdummy.jar" depends="compile">
<jar destfile="gtpdummy.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="gtpdummy.GtpDummy"/>
</manifest>
<fileset dir="build" includes="
 go/Color.class
 go/Move.class
 go/Point.class
 gtp/*.class
 gtpdummy/*.class
 utils/Options.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="gtpregress.jar" depends="compile">
<jar destfile="gtpregress.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="gtpregress.GtpRegress"/>
</manifest>
<fileset dir="build" includes="
 go/Color.class
 go/Move.class
 go/Point.class
 gtp/*.class
 gtpregress/*.class
 utils/FileUtils.class
 utils/Options.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="gtpserver.jar" depends="compile">
<jar destfile="gtpserver.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="gtpserver.GtpServer"/>
</manifest>
<fileset dir="build" includes="
 gtpserver/*.class
 utils/Options.class
 utils/StreamCopy.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="netgtp.jar" depends="compile">
<jar destfile="netgtp.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="netgtp.NetGtp"/>
</manifest>
<fileset dir="build" includes="
 netgtp/*.class
 utils/Options.class
 utils/StreamCopy.class
 version/Version.class
"/>
</jar>
</target>

<target name="sgftotex.jar" depends="compile">
<jar destfile="sgftotex.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="sgftotex.SgfToTex"/>
</manifest>
<fileset dir="build" includes="
 go/*.class
 latex/*.class
 sgf/*.class
 sgftotex/*.class
 utils/FileUtils.class
 utils/Options.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="twogtp.jar" depends="compile">
<jar destfile="twogtp.jar" compress="true">
<manifest>
<attribute name="Main-Class" value="twogtp.TwoGtp"/>
</manifest>
<fileset dir="build" includes="
 go/*.class
 gtp/*.class
 sgf/*.class
 twogtp/*.class
 utils/FileUtils.class
 utils/Options.class
 utils/StringUtils.class
 version/Version.class
"/>
</jar>
</target>

<target name="version">
<copy
 file="src/version/Version.java.in"
 tofile="src/version/Version.java" overwrite="true"/>
<loadfile property="version" srcFile="build/version.txt">
<filterchain><striplinebreaks/></filterchain>
</loadfile>
<replace file="src/version/Version.java" token="@VERSION@" value="${version}"/>
</target>

</project>
