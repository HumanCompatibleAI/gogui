<appendix id="xmlformat">

<title>XML Format</title>

<para>
GoGui uses
<ulink url="http://www.rene-grothmann.de/jago/Documentation/xml.html">
Jago's XML format</ulink> for importing and exporting Go games in XML format.
Currently, only files containing a single GoGame element are supported.
</para>

<para>
The document type definition file as retrieved from
<ulink url="http://www.rene-grothmann.de/jago/Documentation/go.dtd">
http://www.rene-grothmann.de/jago/Documentation/go.dtd</ulink> in 10/2007 is
included in the GoGui package in src/net/sf/gogui/xml/go.dtd.
If a file is read with a DOCTYPE containing go.dtd as a local file, but the
local file cannot be found, this copy of go.dtd will be used for validation.
</para>

<para>
The following list documents details of how GoGui handles XML documents,
how it deviates from Jago's DTD file, and how cases are handled in which
Jago's documentation from the web page and the DTD file are ambiguous or
contradicting.
</para>

<itemizedlist>
<listitem>
<simpara>
The root element (Go) is written with the XML namespace attribute
xmlns='http://www.rene-grothmann.de/jago' to allow registering
specific MIME-handlers for Go game files. This attribute is not allowed by
the original DTD file.
</simpara>
</listitem>
<listitem>
<simpara>
Unknown elements or attributes are not preserved between reading and
writing an XML file, but may generate a warning when reading the file.
</simpara>
</listitem>
<listitem>
<simpara>
Pass moves are written as move elements with an empty string for the
at-property. Handling pass moves was first introduced by 
<ulink url="http://homepage.ntlworld.com/daniel.gilder/gosvg.html">
GoSVG</ulink>. Jago has read-support for pass moves since
version 5.0.
</simpara>
</listitem>
<listitem>
<simpara>
The XML documentation says that a paragraph element is optional
for comments that contain only a single paragraph, but go.dtd requires
them. GoGui will always store comments in a paragraph. When reading a file,
GoGui can handle the case of direct text in comments, as long its DOCTYPE
contains no DTD file or a DTD derived from go.dtd that allows direct text
in comments. However mixed text and paragraph elements are not supported.
</simpara>
</listitem>
<listitem>
<simpara>
The XML format contains no support for line-breaks in comments.
According to the documentation, paragraphs elements should handle text as
the HTML paragraph element. GoGui will replace a line-break by a new paragraph
when storing a file. When reading a file, line-breaks and empty lines are
trimmed. Other whitespace is never deleted when storing or reading a comment.
</simpara>
</listitem>
<listitem>
<simpara>
According to the original DTD, valid children of GoGame are Information and
Nodes. Comment is not allowed as the first element in Nodes. However, the
first example on Jago's webpage shows a case, where a Comment and move
elements are direct children of GoGame. GoGui will always use Nodes and will
always embed a Comment in a Node, if it is the first element in Nodes.
When reading, a Comment can be the first element in Nodes, but Nodes is
required.
</simpara>
</listitem>
</itemizedlist>

</appendix>
